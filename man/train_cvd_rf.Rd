% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/train_cvd_rf.R
\name{train_cvd_rf}
\alias{train_cvd_rf}
\title{Train Random Forest Model for CVD Prediction}
\usage{
train_cvd_rf(cleaned_data, cv_folds = 5, num_trees = 400)
}
\arguments{
\item{cleaned_data}{A cleaned \code{tibble} from \code{preprocess_heart_data()} (must include \code{cardio} target column).}

\item{cv_folds}{An integer specifying the number of cross-validation folds (default: 5, aligns with ML best practices).}

\item{num_trees}{An integer specifying the number of trees in the random forest (default: 400, balances performance/speed).}
}
\value{
A list with 4 components for downstream use (prediction, evaluation, Shiny):
\itemize{
\item \code{model}: Trained random forest model (from \code{caret::train()}) with optimized hyperparameters.
\item \code{prep_recipe}: Fitted \code{recipes} object for preprocessing (imputation + one-hot encoding, trained on training data).
\item \code{test_data}: Hold-out test set (15\% of input data) for final model evaluation (never used for training/validation).
\item \code{positive_level}: Character string ("CVD") specifying the positive class for prediction/evaluation.
}
}
\description{
Trains a reproducible random forest model (via \code{ranger}) for cardiovascular disease (CVD) prediction,
following BIO215 requirements: no data leakage, cross-validation, and compatibility with Shiny app/R package.
Includes preprocessing (imputation, one-hot encoding) fitted \strong{only on training data} to prevent leakage.
}
\details{
Key steps aligned with BIO215 project rubrics:
\enumerate{
\item \strong{Leakage Prevention}:
\itemize{
\item Data split (70\% train, 15\% val, 15\% test) via stratified sampling (preserves \code{cardio} class balance).
\item Preprocessing (\code{recipes}): Median imputation for numerics, mode imputation for categorics, one-hot encodingâ€”\strong{all fitted on training data only}.
}
\item \strong{Model Optimization}:
\itemize{
\item Hyperparameter grid search (mtry: 3/7, splitrule: "gini"/"extratrees", min.node.size: 1/5) via 5-fold CV.
\item Parallel computing (uses all CPU cores - 1) to speed up CV.
}
\item \strong{Reproducibility}: Fixed random seed (42) for data splitting and model training.
}
}
\examples{
# Load preprocessed data
cleaned_data <- preprocess_heart_data("data/heart_data.csv")

# Train random forest model
cvd_model <- train_cvd_rf(cleaned_data, cv_folds = 5, num_trees = 400)

# View best hyperparameters from CV
print(cvd_model$model$bestTune)
}
